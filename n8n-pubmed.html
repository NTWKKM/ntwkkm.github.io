<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏™‡∏£‡∏∏‡∏õ Workflow: ‡∏Å‡∏£‡∏≠‡∏á PubMed Paper ‡∏£‡∏≤‡∏¢‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå (NCBI + n8n)</title>
    <style>
        :root {
            --bg-body: #D0D0D0;
            --bg-card: #EDEDED; 
            --text-main: #333;
            --heading-primary: #2c3e50;
            --heading-secondary: #e67e22; 
            --color-code-inline: #c0392b; 
            --bg-code-block: #2d3436; 
            --text-code-block: #dfe6e9; 
            --border-primary: #ccc;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-main);
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--bg-body);
        }
        h1 { color: var(--heading-primary); border-bottom: 2px solid var(--border-primary); padding-bottom: 10px; }
        h2 { color: var(--heading-secondary); margin-top: 35px; border-left: 4px solid var(--heading-secondary); padding-left: 10px; }
        .card {
            background-color: var(--bg-card); 
            padding: 25px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        code {
            background-color: #f0f2f5; 
            padding: 2px 6px;
            border-radius: 4px;
            font-family: "Consolas", "Monaco", monospace;
            color: var(--color-code-inline);
            font-size: 0.95em;
        }
        pre {
            background-color: var(--bg-code-block); 
            color: var(--text-code-block); 
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 0.9em;
            margin: 15px 0;
        }
        .step-header {
            font-weight: bold;
            color: var(--heading-primary);
            margin-bottom: 10px;
        }
        .warning {
            background-color: #fff3cd; 
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
    </style>
</head>
<body>

    <h1>‡∏™‡∏£‡∏∏‡∏õ Workflow: ‡∏Å‡∏£‡∏≠‡∏á PubMed Paper ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå</h1>
    <p>Workflow ‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏Å 5 ‡∏™‡πà‡∏ß‡∏ô ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ **QueryKey** ‡πÅ‡∏•‡∏∞ **WebEnv** ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ‡πÅ‡∏•‡∏∞‡πÉ‡∏ä‡πâ Python ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á‡∏°‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</p>

    <div class="card">
        <h2>1. üéØ E-Search: ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ PMIDs ‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á WebEnv</h2>
        <p class="step-header">Node: HTTP Request (GET) </p>
        <p>Endpoint: <code>https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi</code></p>
        
        <p><strong>Query Parameters:</strong></p>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Value</th>
                    <th>‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>db</code></td>
                    <td><code>pubmed</code></td>
                    <td>‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td>
                </tr>
                <tr>
                    <td><code>term</code></td>
                    <td><code>emergency medicine</code></td>
                    <td>‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</td>
                </tr>
                <tr>
                    <td><code>mindate</code></td>
                    <td><code>7</code></td>
                    <td>7 ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡πâ‡∏ß</td>
                </tr>
                <tr>
                    <td><code>maxdate</code></td>
                    <td><code>today</code></td>
                    <td>‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</td>
                </tr>
                <tr>
                    <td><code>retmax</code></td>
                    <td><code>100</code></td>
                    <td>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</td>
                </tr>
                <tr>
                    <td><code>usehistory</code></td>
                    <td><code>y</code></td>
                    <td><strong>‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ NCBI ‡πÄ‡∏Å‡πá‡∏ö‡∏ä‡∏∏‡∏î‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (WebEnv) ‡πÑ‡∏ß‡πâ</td>
                </tr>
                <tr>
                    <td><code>api_key</code></td>
                    <td><code>&lt;API Key ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì&gt;</code></td>
                    <td></td>
                </tr>
            </tbody>
        </table>
        <div class="warning">
            <p><strong>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:</strong> ‡πÄ‡∏£‡∏≤‡∏ï‡∏±‡∏î <code>datetype</code> ‡∏≠‡∏≠‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ <code>mindate/maxdate</code></p>
        </div>
    </div>

    <div class="card">
        <h2>2. üêç Python Code #1: ‡∏î‡∏∂‡∏á QueryKey & WebEnv</h2>
        <p class="step-header">Node: Code (Python) </p>
        <p>‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ Library ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á Python (<code>xml.etree.ElementTree</code>) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏õ‡∏•‡∏á XML ‡πÅ‡∏•‡∏∞‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô E-Fetch</p>
        <pre>
import xml.etree.ElementTree as ET
import json

xml_string = items[0]['json']['data']

try:
    root = ET.fromstring(xml_string)
except Exception as e:
    return []

# ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤ QueryKey ‡πÅ‡∏•‡∏∞ WebEnv
query_key = root.find('QueryKey').text
web_env = root.find('WebEnv').text

# ‡∏Ñ‡∏∑‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô JSON Object
return [{
    "query_key": query_key,
    "web_env": web_env,
}]</pre>
    </div>

    <div class="card">
        <h2>3. üöÄ E-Fetch: ‡∏î‡∏∂‡∏á XML Full Record (Medline)</h2>
        <p class="step-header">Node: HTTP Request (GET) </p>
        <p>Endpoint: <code>https://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi</code></p>
        <p>Node ‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ QueryKey ‡πÅ‡∏•‡∏∞ WebEnv ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏∂‡∏á XML Full Record ‡∏ó‡∏µ‡πà‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô (Medline) ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß‡πÅ‡∏•‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏°‡∏≤‡∏Å</p>
        
        <p><strong>Query Parameters:</strong></p>
        <table>
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Value (Expression)</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><code>db</code></td>
                    <td><code>pubmed</code></td>
                </tr>
                <tr>
                    <td><code>query_key</code></td>
                    <td><code>{{ $json.query_key }}</code></td>
                </tr>
                <tr>
                    <td><code>WebEnv</code></td>
                    <td><code>{{ $json.web_env }}</code></td>
                </tr>
                <tr>
                    <td><code>retmode</code></td>
                    <td><code>xml</code></td>
                </tr>
                <tr>
                    <td><code>rettype</code></td>
                    <td>(‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡πà‡∏≤‡∏á‡πÑ‡∏ß‡πâ)</td>
                </tr>
                <tr>
                    <td><code>api_key</code></td>
                    <td><code>&lt;API Key ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì&gt;</code></td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="card">
        <h2>4. üî™ Python Code #2: ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏≠‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Title ‡πÅ‡∏•‡∏∞ URL</h2>
        <p class="step-header">Node: Code (Python) </p>
        <p>‡πÇ‡∏Ñ‡πâ‡∏î‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏£‡∏±‡∏ö XML Full Record ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤ ‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á‡∏ó‡∏¥‡πâ‡∏á Abstract/Authors/MeSH Terms ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÑ‡∏ß‡πâ‡πÅ‡∏Ñ‡πà **PMID** ‡πÅ‡∏•‡∏∞ **Title** ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î</p>
        <pre>
import xml.etree.ElementTree as ET

xml_string = items[0]['json']['data']

try:
    root = ET.fromstring(xml_string)
except Exception as e:
    print(f"E-Fetch XML Parsing Error: {e}")
    return []

results = []

# ‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô Tag 'PubmedArticle'
for article in root.findall('PubmedArticle'):
    try:
        # 1. ‡∏î‡∏∂‡∏á PMID
        pmid_element = article.find('.//PMID')
        pmid = pmid_element.text if pmid_element is not None else "N/A"
        
        # 2. ‡∏î‡∏∂‡∏á Title
        title_element = article.find('.//ArticleTitle') 
        title = title_element.text if title_element is not None else "No Title Found"
        
        # 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á URL
        pubmed_url = f"https://pubmed.ncbi.nlm.nih.gov/{pmid}/"
        
        results.append({
            "PMID": pmid,
            "Title": title,
            "URL": pubmed_url 
        })
    except Exception:
        continue

return results</pre>
    </div>

    <div class="card">
        <h2>5. üîî ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢: ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h2>
        <p class="step-header">Node: LINE Messaging / Slack / Email </p>
        <p>‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ JSON Array ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÅ‡∏ï‡πà Title ‡πÅ‡∏•‡∏∞ URL ‡∏Ç‡∏≠‡∏á‡∏ö‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏° 100 ‡∏ä‡∏¥‡πâ‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡∏¢‡∏±‡∏á Node ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ</p>
        <p><strong>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:</strong> ‡πÉ‡∏ä‡πâ <strong>Item List Node</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏ß‡∏°‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß ‡πÜ ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡πÑ‡∏õ‡∏ó‡∏µ‡πà LINE Notify</p>
    </div>

</body>
</html>
