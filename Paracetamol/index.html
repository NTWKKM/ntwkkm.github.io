```html
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acetaminophen Poisoning Management Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
        .card {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1),
                        0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        .btn {
            background-color: #3b82f6;
            transition: background-color 0.3s;
            color: white;
        }
        .btn:hover { background-color: #2563eb; }
        input, select {
            background-color: #f3f4f6;
            border-color: #d1d5db;
            color: #1f2937;
        }
        .result-box {
            background-color: #eff6ff;
            border-left: 4px solid #3b82f6;
        }
        .header-text { color: #111827; }
        .label-text { color: #374151; }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto space-y-8">
        <header class="text-center">
            <h1 class="text-3xl md:text-4xl font-bold header-text">Acetaminophen Poisoning Management Tool</h1>
            <p class="text-lg text-gray-600 mt-2">กลุ่มงานเวชศาสตร์ฉุกเฉิน รพ.มหาราชนครราชสีมา</p>
        </header>

        <!-- Patient Data Section -->
        <div class="card rounded-lg p-6">
            <h2 class="text-2xl font-bold mb-4 border-b border-gray-200 pb-2">1. ข้อมูลและการประเมินผู้ป่วย</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label for="scenario" class="block text-sm font-medium label-text mb-2">สถานการณ์ผู้ป่วย:</label>
                    <select id="scenario" class="w-full rounded-md p-2">
                        <option value="acute">Acute Ingestion (ทราบเวลาชัดเจน, < 24 ชม.)</option>
                        <option value="unknown">Unknown Time / Unreliable History</option>
                        <option value="repeated">Repeated Supratherapeutic Ingestion (RSI)</option>
                        <option value="extended">Extended-Release / Co-ingestion</option>
                    </select>
                </div>
                <div>
                    <label for="patient-age" class="block text-sm font-medium label-text mb-2">อายุ (ปี):</label>
                    <input type="number" id="patient-age" placeholder="เช่น 25" class="w-full rounded-md p-2">
                </div>
                 <div>
                    <label for="initial-time" class="block text-sm font-medium label-text mb-2">เวลาหลังได้รับยา (ชม.):</label>
                    <input type="number" id="initial-time" placeholder="เช่น 2" class="w-full rounded-md p-2">
                </div>
                <div>
                    <label for="patient-weight-input" class="block text-sm font-medium label-text mb-2">น้ำหนัก (kg):</label>
                    <input type="number" id="patient-weight-input" placeholder="เช่น 60" class="w-full rounded-md p-2">
                </div>
                <div>
                    <label for="tablet-mg" class="block text-sm font-medium label-text mb-2">ขนาดยา/เม็ด (mg):</label>
                    <input type="number" id="tablet-mg" placeholder="เช่น 500" class="w-full rounded-md p-2">
                </div>
                <div>
                    <label for="tablet-count" class="block text-sm font-medium label-text mb-2">จำนวนเม็ด:</label>
                    <input type="number" id="tablet-count" placeholder="เช่น 20" class="w-full rounded-md p-2">
                </div>
            </div>
             <div id="assessment-result" class="result-box p-4 rounded-md mt-4 h-full">
                <h3 class="font-bold text-lg mb-2">คำแนะนำเบื้องต้น:</h3>
                <p id="scenario-advice">เลือกสถานการณ์เพื่อดูคำแนะนำ</p>
                <p id="dose-assessment" class="mt-2 font-semibold"></p>
            </div>
        </div>

        <!-- Initial Management Section -->
        <div class="card rounded-lg p-6">
            <h2 class="text-2xl font-bold mb-4 border-b border-gray-200 pb-2">2. การจัดการเบื้องต้น</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="font-bold text-lg text-blue-600 mb-2">เกณฑ์ประเมินขนาดยาที่เป็นพิษ (Toxic Dose)</h3>
                    <div class="space-y-3">
                        <div>
                            <p class="font-semibold">Acute Ingestion (ได้รับยาครั้งเดียว)</p>
                            <ul class="list-disc list-inside text-sm label-text">
                                <li><strong>ผู้ใหญ่ หรือเด็ก ≥ 6 ปี:</strong> > 10 กรัม หรือ > 200 mg/kg</li>
                                <li><strong>เด็ก < 6 ปี:</strong> > 200 mg/kg</li>
                            </ul>
                        </div>
                        <div>
                            <p class="font-semibold">Repeated Supratherapeutic Ingestion (RSI)</p>
                             <ul class="list-disc list-inside text-sm label-text">
                                <li>> 6 กรัม/24ชม. หรือ > 150 mg/kg/24ชม. (ติดต่อกันอย่างน้อย 2 วัน)</li>
                            </ul>
                        </div>
                    </div>
                    <div id="dose-summary" class="mt-4 text-sm text-gray-700"></div>
                </div>
                 <div>
                    <h3 class="font-bold text-lg text-blue-600 mb-2">แนวทางการให้ Activated Charcoal</h3>
                    <div class="space-y-2">
                        <p class="font-semibold">ขนาด: 1 g/kg (สูงสุด 50 g)</p>
                        <ul class="list-disc list-inside text-sm label-text">
                            <li>พิจารณาให้หากผู้ป่วยมาถึง รพ. <strong>ภายใน 4 ชั่วโมง</strong></li>
                             <li>อาจพิจารณาให้ <strong>หลัง 4 ชั่วโมง</strong> ได้หาก Extended-Release หรือกินร่วมกับยาอื่นที่ชะลอการดูดซึม</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Nomogram Section -->
            <div class="card rounded-lg p-6">
                <h2 class="text-2xl font-bold mb-4 border-b border-gray-200 pb-2">3. Modified Rumack-Matthew Nomogram</h2>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label for="time-since-ingestion" class="block text-sm font-medium label-text">เวลาหลังได้รับยา (ชม.)</label>
                        <input type="number" id="time-since-ingestion" placeholder="4-24" class="w-full mt-1 rounded-md p-2">
                    </div>
                    <div>
                        <label for="apap-level" class="block text-sm font-medium label-text">ระดับยา APAP (µg/mL)</label>
                        <input type="number" id="apap-level" placeholder="เช่น 150" class="w-full mt-1 rounded-md p-2">
                    </div>
                    <button id="plot-button" class="btn font-bold rounded-md sm:self-end h-10">Plot Point</button>
                </div>
                <div id="plot-result" class="text-center font-semibold text-lg p-2 min-h-[40px]"></div>
                <div class="relative h-96 w-full">
                    <canvas id="nomogramChart"></canvas>
                </div>
            </div>

            <!-- NAC Dose Calculator -->
            <div class="card rounded-lg p-6">
                <h2 class="text-2xl font-bold mb-4 border-b border-gray-200 pb-2">4. คำนวณขนาดยา Acetylcysteine (IV NAC)</h2>
                <div class="flex items-end gap-4 mb-4">
                    <div class="flex-grow">
                        <label for="patient-weight" class="block text-sm font-medium label-text">น้ำหนักผู้ป่วย (kg)</label>
                        <input type="number" id="patient-weight" placeholder="เช่น 60" class="w-full mt-1 rounded-md p-2">
                    </div>
                    <button id="calculate-nac" class="btn font-bold rounded-md h-10 px-6">คำนวณ</button>
                </div>
                <div id="nac-result" class="space-y-3"></div>
            </div>
        </div>
        
        <!-- Special Cases Section -->
        <div class="card rounded-lg p-6">
            <h2 class="text-2xl font-bold mb-4 border-b border-gray-200 pb-2">5. เกณฑ์การพิจารณาพิเศษ</h2>
            ...
        </div>

        <!-- NAC Adverse Reaction Management -->
        <div class="card rounded-lg p-6">
            <h2 class="text-2xl font-bold mb-4 border-b border-gray-200 pb-2">6. การจัดการผลข้างเคียงจากยา NAC</h2>
            ...
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const scenarioSelect = document.getElementById('scenario');
            const scenarioAdvice = document.getElementById('scenario-advice');
            const doseAssessment = document.getElementById('dose-assessment');
            const doseSummary = document.getElementById('dose-summary');

            const ageInput = document.getElementById('patient-age');
            const weightInput1 = document.getElementById('patient-weight-input');
            const weightInput2 = document.getElementById('patient-weight');
            const tabletMgInput = document.getElementById('tablet-mg');
            const tabletCountInput = document.getElementById('tablet-count');

            const calculateNacButton = document.getElementById('calculate-nac');
            const nacResultDiv = document.getElementById('nac-result');

            const scenarios = {
                acute: 'เจาะเลือดวัดระดับ Acetaminophen ที่เวลา 4-24 ชั่วโมง...',
                unknown: 'เจาะเลือดวัดระดับ Acetaminophen, AST, ALT ทันที...',
                repeated: 'เจาะเลือดวัดระดับ Acetaminophen, AST, ALT, Creatinine...',
                extended: 'เจาะเลือดที่ 4-12 ชั่วโมงหลังได้รับยา...'
            };

            function updateScenarioAdvice() {
                scenarioAdvice.textContent = scenarios[scenarioSelect.value];
            }
            scenarioSelect.addEventListener('change', updateScenarioAdvice);
            updateScenarioAdvice();

            function checkDose() {
                const weight = parseFloat(weightInput1.value);
                const age = parseFloat(ageInput.value);
                const tabletMg = parseFloat(tabletMgInput.value);
                const tabletCount = parseFloat(tabletCountInput.value);

                if (!weight || !tabletMg || !tabletCount) {
                    doseAssessment.textContent = '';
                    doseSummary.textContent = '';
                    return;
                }
                const totalDose = tabletMg * tabletCount;
                const mgPerKg = totalDose / weight;

                let toxic = false;
                if (age >= 6) {
                    toxic = mgPerKg > 200 || totalDose > 10000;
                } else {
                    toxic = mgPerKg > 200;
                }

                doseAssessment.textContent = `ได้รับยา ${totalDose} mg (${mgPerKg.toFixed(1)} mg/kg) → ${toxic ? 'เกินเกณฑ์ Toxic Dose! แนะนำพิจารณา NAC' : 'ยังไม่เกินเกณฑ์ Toxic Dose'}`;
                doseAssessment.className = toxic ? 'mt-2 font-bold text-red-600' : 'mt-2 font-semibold text-green-600';

                doseSummary.textContent = `รวมขนาดยาที่ได้รับ: ${totalDose} mg (${mgPerKg.toFixed(1)} mg/kg)`;

                // sync น้ำหนักไปข้อ 4
                if (weight && !isNaN(weight)) weightInput2.value = weight;
            }
            [weightInput1, tabletMgInput, tabletCountInput, ageInput].forEach(el => el.addEventListener('input', checkDose));

            calculateNacButton.addEventListener('click', () => {
                const weight = parseFloat(weightInput2.value);
                if (isNaN(weight) || weight <= 0) {
                    nacResultDiv.innerHTML = `<p class="text-amber-600">กรุณาใส่น้ำหนักให้ถูกต้อง</p>`;
                    return;
                }
                const calculationWeight = Math.min(weight, 100);
                const weightCapped = weight > 100;

                const loadingDoseMg = 150 * calculationWeight;
                const secondDoseMg = 50 * calculationWeight;
                const thirdDoseMg = 100 * calculationWeight;

                const loadingFluid = weight < 21 ? 3 * calculationWeight : (weight < 41 ? 100 : 200);
                const secondFluid = weight < 21 ? 7 * calculationWeight : (weight < 41 ? 250 : 500);
                const thirdFluid = weight < 21 ? 14 * calculationWeight : (weight < 41 ? 500 : 1000);

                nacResultDiv.innerHTML = `
                    ${weightCapped ? `<div class="result-box p-3 rounded-md border-amber-500"><p class="text-amber-600 font-semibold">หมายเหตุ: จำกัดน้ำหนักที่ใช้คำนวณสูงสุด 100 kg</p></div>` : ''}
                    <div class="result-box p-4 rounded-md">
                        <h4 class="font-bold text-lg">Loading Dose (1 ชั่วโมง)</h4>
                        <p>${loadingDoseMg.toFixed(0)} mg NAC in D5W ${loadingFluid} mL, IV drip over 60 นาที</p>
                    </div>
                    <div class="result-box p-4 rounded-md">
                        <h4 class="font-bold text-lg">Second Dose (4 ชั่วโมง)</h4>
                        <p>${secondDoseMg.toFixed(0)} mg NAC in D5W ${secondFluid} mL, IV drip over 4 ชั่วโมง</p>
                    </div>
                    <div class="result-box p-4 rounded-md">
                        <h4 class="font-bold text-lg">Third Dose (16 ชั่วโมง)</h4>
                        <p>${thirdDoseMg.toFixed(0)} mg NAC in D5W ${thirdFluid} mL, IV drip over 16 ชั่วโมง</p>
                    </div>
                `;
            });
        });
    </script>
 <div class="footer">
    &copy; 2025 NTWKKM &nbsp;|&nbsp; Powered by GitHub Pages
  </div>
</body>
</html>
```
