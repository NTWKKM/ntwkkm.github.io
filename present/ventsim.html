<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏¢‡πÉ‡∏à (VentSim Dual-Lung)</title>
    <style>
        /* --- Styles (Dark Mode) --- */
        body { font-family: 'Sukhumvit Set', 'Kanit', sans-serif; line-height: 1.7; color: #eeeeee; margin: 0; padding: 20px; background-color: #222831; }
        .container { max-width: 900px; margin: auto; background: #393e46; padding: 30px 40px; border-radius: 16px; box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4); }
        
        h1 { color: #74d0f7; border-bottom: 4px solid #74d0f7; padding-bottom: 12px; margin-bottom: 30px; text-align: center; font-size: 2em; font-weight: 800; }
        h2 { color: #a4c9ff; border-left: 6px solid #4a90e2; padding-left: 15px; margin-top: 40px; margin-bottom: 20px; font-size: 1.5em; font-weight: 700; background-color: #4a5462; padding-top: 5px; padding-bottom: 5px; border-radius: 4px; }
        h3 { color: #4ade80; margin-top: 25px; margin-bottom: 12px; font-size: 1.25em; font-weight: 700; }
        
        .equation { 
            background-color: #2e343d; border: 1px solid #4a90e2; border-radius: 8px; padding: 20px; margin: 20px 0 0; 
            overflow-x: auto; font-family: 'Consolas', 'Courier New', monospace; font-size: 1.2em; font-weight: 700; text-align: center;
        }
        .equation strong { color: #74d0f7; }
        .info-box { background-color: #4a4f56; border: 1px solid #757b85; padding: 15px; margin: 15px 0; border-radius: 8px; font-size: 0.95em; }
        .info-box p, .info-box ul { color: #dddddd; }
        .highlight { color: #ff7f7f; font-weight: 700; }
        .icon { font-size: 1.2em; margin-right: 8px; }

        /* Color Coding Boxes */
        .elastic-box { background-color: #424f46; border-color: #4ade80; }
        .resistive-box { background-color: #554446; border-color: #ff7f7f; }
        .gas-exchange-box { background-color: #40485a; border-color: #74d0f7; }
        .setting-box { background-color: #444a56; border-color: #a4c9ff; }
        .graph-box { background-color: #424653; border-color: #f7b44e; }

        hr { border: 0; height: 1px; background-color: #555555; margin: 30px 0; }

        /* Simulation UI */
        .sim-container { background-color: #1e2126; border: 1px solid #555; border-radius: 8px; padding: 15px; margin-top: 20px; }
        .controls { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; align-items: center; }
        .btn { 
            background-color: #393e46; color: white; border: 1px solid #4a90e2; padding: 8px 16px; border-radius: 4px; cursor: pointer; transition: 0.2s; font-family: inherit; font-size: 0.9em;
        }
        .btn:hover { background-color: #4a90e2; }
        .btn.active { background-color: #4a90e2; font-weight: bold; box-shadow: 0 0 8px rgba(74, 144, 226, 0.5); }
        .btn.control-btn { border-color: #f7b44e; color: #f7b44e; }
        .btn.control-btn:hover { background-color: #f7b44e; color: #222; }
        .btn.control-btn.paused { background-color: #f7b44e; color: #222; }
        
        canvas { background-color: #000; border: 1px solid #333; width: 100%; display: block; margin-bottom: 5px; border-radius: 4px; }
        .monitor-values { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 10px; }
        .monitor-card { background: #222; padding: 8px; border-radius: 4px; text-align: center; border: 1px solid #444; }
        .monitor-label { font-size: 0.8em; color: #aaa; display: block; }
        .monitor-val { font-size: 1.2em; font-weight: bold; color: #fff; }
        .text-blue { color: #4a90e2; } .text-green { color: #4ade80; } .text-red { color: #ff7f7f; } .text-yellow { color: #f7b44e; }
    </style>
</head>
<body>
    <div class="container">
        <h1>‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≤‡∏á‡∏ü‡∏¥‡∏™‡∏¥‡∏Å‡∏™‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏¢‡πÉ‡∏à (VentSim Dual-Lung)</h1>
        <p>‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ **Non-Linear Model** ‡∏ã‡∏∂‡πà‡∏á‡∏ï‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏•‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÅ‡∏ö‡∏ö‡∏î‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏¥‡∏° ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏°‡∏µ‡∏û‡∏¢‡∏≤‡∏ò‡∏¥‡∏™‡∏†‡∏≤‡∏û‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô (Dual-Lung) ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏°‡∏à‡∏£‡∏¥‡∏á</p>

        <div class="sim-container">
            <h3 style="margin-top:0; color:#fff; border-bottom:1px solid #444; padding-bottom:10px;">
                <span class="icon">üíª</span> Live Simulation (‡∏Å‡∏£‡∏≤‡∏ü‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á)
            </h3>
            <div style="font-size: 0.9em; color: #aaa; margin-bottom: 10px;">
                <strong>Setting:</strong> Mode: PCV | Pinsp: 10 | PEEP: 5 | RR: 14 | Ti: 1.0s | Pmus: 0 | <strong>Display: ~6-7 Breath Cycles (30s)</strong>
            </div>
            
            <div class="controls">
                <button class="btn control-btn" id="btn-toggle" onclick="toggleSim()">‚è∏ Pause</button>
                <div style="width: 1px; height: 30px; background: #444; margin: 0 10px;"></div>
                <button class="btn active" onclick="setPreset('NORMAL')">Normal</button>
                <button class="btn" onclick="setPreset('ARDS')">ARDS (Stiff)</button>
                <button class="btn" onclick="setPreset('COPD')">COPD (Obstructive)</button>
                <button class="btn" onclick="setPreset('DUAL')">Dual-Lung (Unilateral)</button>
            </div>

            <div class="monitor-values">
                <div class="monitor-card"><span class="monitor-label">Ppeak</span><span class="monitor-val text-yellow" id="val-ppeak">--</span></div>
                <div class="monitor-card"><span class="monitor-label">Vte (ml)</span><span class="monitor-val text-blue" id="val-vte">--</span></div>
                <div class="monitor-card"><span class="monitor-label">MV (L)</span><span class="monitor-val text-green" id="val-mv">--</span></div>
                <div class="monitor-card"><span class="monitor-label">RR</span><span class="monitor-val text-blue">14</span></div>
            </div>

            <canvas id="waveforms" height="300"></canvas>
            </div>

        <hr>
        <h2><span class="icon">‚öôÔ∏è</span> 1. ‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞‡∏ß‡∏á‡∏à‡∏£‡∏Ñ‡∏π‡πà‡∏Ç‡∏ô‡∏≤‡∏ô (Dual-Lung)</h2>
        <p>‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏Ñ‡∏∑‡∏≠‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÄ‡∏Ñ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà ‡∏ã‡∏∂‡πà‡∏á‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏õ‡∏≠‡∏î‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ (P<sub>alv</sub>) ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å 3 ‡∏™‡πà‡∏ß‡∏ô:</p>

        <div class="equation">
            P<sub>alv</sub> = (V / C) &nbsp;&nbsp;+&nbsp;&nbsp; (F &middot; R) &nbsp;&nbsp;+&nbsp;&nbsp; PEEP &nbsp;&nbsp;-&nbsp;&nbsp; P<sub>mus</sub>
        </div>
        <div style="font-size: 0.9em; text-align: center; margin-top: 5px; margin-bottom: 20px;">
            <span style="color: #4ade80; margin-right: 50px;">(Elastic P.)</span> <span style="color: #ff7f7f;">(Resistive P.)</span>
        </div>

        <h3><span class="icon">ü´Å</span> ‡∏ß‡∏á‡∏à‡∏£‡∏Ñ‡∏π‡πà‡∏Ç‡∏ô‡∏≤‡∏ô (Dual-Lung Parallel Circuit)</h3>
        <div class="info-box elastic-box">
            <p style="color: #4ade80;">**‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢:** ‡∏õ‡∏≠‡∏î‡∏ã‡πâ‡∏≤‡∏¢ (R<sub>L</sub>, C<sub>L</sub>) ‡πÅ‡∏•‡∏∞‡∏õ‡∏≠‡∏î‡∏Ç‡∏ß‡∏≤ (R<sub>R</sub>, C<sub>R</sub>) ‡∏ñ‡∏π‡∏Å‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏ß‡∏á‡∏à‡∏£‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡πÅ‡∏ö‡∏ö‡∏Ç‡∏ô‡∏≤‡∏ô ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏õ‡∏≠‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô ‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏® (F) ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö:</p>
            <ul>
                <li>**‡∏õ‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ R &middot; C (Time Constant) ‡∏ï‡πà‡∏≥:** ‡∏õ‡∏≠‡∏î‡∏à‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÅ‡∏•‡∏∞‡∏¢‡∏∏‡∏ö‡∏ï‡∏±‡∏ß‡∏à‡∏ô‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏°‡∏î‡∏∏‡∏•‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏Å‡∏ß‡πà‡∏≤ ‡πÅ‡∏•‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö Volume ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î PCV/PSV</li>
            </ul>
        </div>
        
        <h3><span class="icon">üí®</span> Circuit Compliance</h3>
        <p>‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢‡πÑ‡∏õ‡πÉ‡∏ô‡∏™‡∏≤‡∏¢‡∏ß‡∏á‡∏à‡∏£‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏¢‡πÉ‡∏à (volCircuit) ‡∏ã‡∏∂‡πà‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏õ‡∏≠‡∏î ‡πÅ‡∏ï‡πà‡∏ñ‡∏π‡∏Å‡∏ô‡∏±‡∏ö‡∏£‡∏ß‡∏°‡πÉ‡∏ô flowTotal ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ ‡∏ó‡∏≥‡πÉ‡∏´‡πâ Vt ‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏≠‡∏î‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</p>

        <hr>
        <h2><span class="icon">üî¨</span> 2. ‡∏Å‡∏•‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏ä‡∏¥‡∏á‡πÄ‡∏™‡πâ‡∏ô (Non-Linear Mechanics)</h2>
        <p>‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≤‡∏ô‡∏ó‡∏≤‡∏ô (R) ‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô (C) ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà ‡πÅ‡∏ï‡πà‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏ï‡∏≤‡∏°‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡∏Ç‡∏≠‡∏á‡∏õ‡∏≠‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ <strong class="highlight">Pressure-Volume Loop ‡πÅ‡∏•‡∏∞ Flow-Volume Loop ‡∏ó‡∏µ‡πà‡πÇ‡∏Ñ‡πâ‡∏á‡∏á‡∏≠‡∏ï‡∏≤‡∏°‡∏û‡∏¢‡∏≤‡∏ò‡∏¥‡∏™‡∏†‡∏≤‡∏û‡∏à‡∏£‡∏¥‡∏á</strong></p>

        <h3>2.1 Dynamic Compliance: ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏à‡∏≤‡∏Å‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ (Volume Dependence)</h3>
        <div class="info-box resistive-box">
            <p style="color: #ff7f7f;"><span class="icon">üéà</span> **Balloon Effect:** ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∑‡∏î‡∏´‡∏¢‡∏∏‡πà‡∏ô‡∏õ‡∏≠‡∏î‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏õ‡∏£‡∏±‡∏ö‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏õ‡∏≠‡∏î (V<sub>current</sub>):</p>
            <ul>
                <li>**Overdistension (Upper Inflection):** ‡πÄ‡∏°‡∏∑‡πà‡∏≠ V<sub>current</sub> ‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ç‡∏µ‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î ‡∏Ñ‡πà‡∏≤ C ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏î‡∏•‡∏á‡πÅ‡∏ö‡∏ö <strong class="highlight">Exponential Stiffness</strong> ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏†‡∏≤‡∏ß‡∏∞‡∏õ‡∏≠‡∏î‡∏ï‡∏∂‡∏á‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</li>
                <li>**Recruitment (Hysteresis):** ‡πÉ‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÄ‡∏Ç‡πâ‡∏≤ ‡∏Ñ‡πà‡∏≤ C ‡∏à‡∏∞‡∏ï‡πà‡∏≥‡∏•‡∏á‡∏Å‡∏ß‡πà‡∏≤‡∏ä‡πà‡∏ß‡∏á‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏≠‡∏≠‡∏Å‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏ñ‡∏∏‡∏á‡∏•‡∏°‡∏ó‡∏µ‡πà‡∏¢‡∏∏‡∏ö‡∏ï‡∏±‡∏ß</li>
            </ul>
        </div>

        <h3>2.2 Dynamic Resistance: ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£</h3>
        <div class="info-box resistive-box">
            <p style="color: #ff7f7f;"><span class="icon">üå™Ô∏è</span> **Airway Dynamics:** ‡∏Ñ‡πà‡∏≤ R ‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏• (F) ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£ (V):</p>
            <ul>
                <li>**Flow Dependence:** R ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡∏≤‡∏° |F| ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏•‡∏≠‡∏á <strong class="highlight">Turbulence (‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡πÅ‡∏ö‡∏ö‡∏õ‡∏±‡πà‡∏ô‡∏õ‡πà‡∏ß‡∏ô)</strong> (‡∏ï‡∏≤‡∏°‡∏Å‡∏é‡∏Ç‡∏≠‡∏á Rohrer's)</li>
                <li>**Volume Dependence:** R ‡∏•‡∏î‡∏•‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠ V ‡∏™‡∏π‡∏á ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏†‡∏≤‡∏ß‡∏∞ **Airway Tethering** (‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏õ‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏î‡∏∂‡∏á‡πÉ‡∏´‡πâ‡∏ó‡πà‡∏≠‡∏•‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏Ç‡∏∂‡πâ‡∏ô)</li>
            </ul>
        </div>

        <hr>
        <h2><span class="icon">üß™</span> 3. ‡∏û‡∏¢‡∏≤‡∏ò‡∏¥‡∏™‡∏†‡∏≤‡∏û (Pathology Presets)</h2>
        <p>‡πÅ‡∏ï‡πà‡∏•‡∏∞ Preset ‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ R, C, Shunt, Deadspace ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡∏ó‡∏≤‡∏á‡∏™‡∏£‡∏µ‡∏£‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö Patient Mechanics ‡∏°‡∏µ‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</p>
        <div class="info-box setting-box">
            <h4 style="color: #a4c9ff; font-weight: bold;">Presets ‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏´‡∏•‡∏±‡∏Å:</h4>
            <ul>
                <li>**NORMAL:** ‡∏Ñ‡πà‡∏≤‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á. Time Constant ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°.</li>
                <li>**ARDS (Restrictive):** C ‡∏ï‡πà‡∏≥ (‡∏õ‡∏≠‡∏î‡πÅ‡∏Ç‡πá‡∏á), Shunt ‡πÅ‡∏•‡∏∞ Deadspace ‡∏™‡∏π‡∏á <strong class="highlight">(‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠ Hypoxemia ‡πÅ‡∏•‡∏∞ VILI)</strong></li>
                <li>**COPD (Obstructive):** R ‡∏™‡∏π‡∏á (‡∏´‡∏•‡∏≠‡∏î‡∏•‡∏°‡∏ï‡∏µ‡∏ö), Deadspace ‡∏™‡∏π‡∏á <strong class="highlight">(‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠ Air Trapping/AutoPEEP)</strong></li>
                <li>**UNILATERAL C/R DEC/INC:** ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Ç‡∏≠‡∏á **Dual-Lung Circuit** ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏õ‡∏≠‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏Ç‡πâ‡∏≤‡∏á‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö Volume ‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô (Uneven Ventilation)</li>
            </ul>
        </div>

        <hr>
        <h2><span class="icon">üéõÔ∏è</span> 4. ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡∏µ‡∏£‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤</h2>
        <p>‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏°‡∏µ‡∏ú‡∏•‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏≤‡∏î‡πÄ‡∏à‡πá‡∏ö‡∏Ç‡∏≠‡∏á‡∏õ‡∏≠‡∏î (VILI) ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏†‡∏≤‡∏ß‡∏∞‡∏Å‡πä‡∏≤‡∏ã‡πÉ‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏î:</p>

        <div class="info-box setting-box">
            <ul>
                <li>**Vt (Tidal Volume):** ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏õ‡∏≠‡∏î‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á. ‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏Å‡∏±‡∏î V<sub>t</sub> (‡πÄ‡∏ä‡πà‡∏ô 4-8 ml/kg PBW) ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏° Driving Pressure ‡πÅ‡∏•‡∏∞‡∏•‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á <strong class="highlight">Volutrauma</strong></li>
                <li>**Pinsp / PS (Pressure):** ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î. ‡∏´‡∏≤‡∏Å‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ ‡∏≠‡∏≤‡∏à‡∏ó‡∏≥‡πÉ‡∏´‡πâ P<sub>plat</sub> ‡πÄ‡∏Å‡∏¥‡∏ô 30 cmH<sub>2</sub>O ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠ <strong class="highlight">Barotrauma</strong> ‡πÅ‡∏•‡∏∞ Overdistension</li>
                <li>**RR ‡πÅ‡∏•‡∏∞ Ti (Inspiratory Time):** ‡∏Å‡∏≥‡∏´‡∏ô‡∏î T<sub>e</sub> (Expiratory Time). ‡∏´‡∏≤‡∏Å T<sub>e</sub> ‡∏™‡∏±‡πâ‡∏ô‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡πÄ‡∏°‡∏∑‡πà‡∏≠ R ‡∏™‡∏π‡∏á (Time Constant ‡∏¢‡∏≤‡∏ß) ‡∏à‡∏∞‡πÄ‡∏Å‡∏¥‡∏î‡∏†‡∏≤‡∏ß‡∏∞ <strong class="highlight">Air Trapping</strong> ‡πÅ‡∏•‡∏∞ AutoPEEP</li>
                <li>**PEEP:** ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô. PEEP ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ñ‡∏∏‡∏á‡∏•‡∏°‡∏¢‡∏∏‡∏ö‡∏ï‡∏±‡∏ß (Recruitment) ‡πÅ‡∏•‡∏∞‡∏•‡∏î **Shunt** ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° SpO<sub>2</sub> ‡πÅ‡∏ï‡πà PEEP ‡∏ó‡∏µ‡πà‡∏™‡∏π‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ‡∏≠‡∏≤‡∏à‡∏•‡∏î Cardiac Output</li>
                <li>**FiO<sub>2</sub>:** **‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏´‡∏•‡∏±‡∏Å** ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏†‡∏≤‡∏ß‡∏∞ Hypoxemia (SpO<sub>2</sub> ‡∏ï‡πà‡∏≥) ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å **Shunt** ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á</li>
            </ul>
        </div>

        <hr>
        <h2><span class="icon">üìà</span> 5. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤ Monitor</h2>
        <p>‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤ Monitor ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô Mechanics ‡πÅ‡∏•‡∏∞ Gas Exchange ‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡πÅ‡∏ö‡∏ö Real-time:</p>

        <h3>5.1 Monitor Values (‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç)</h3>
        <div class="info-box gas-exchange-box">
            <ul>
                <li>**Pplat (P<sub>plateau</sub>):** ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ß‡∏±‡∏î‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ Inspiratory Hold ‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î (Stress) ‡∏Ç‡∏≠‡∏á‡∏õ‡∏≠‡∏î ‡∏Ñ‡∏ß‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÉ‡∏´‡πâ **Pplat &lt; 30** cmH<sub>2</sub>O</li>
                <li>**Driving Pressure (P<sub>plat</sub> - PEEP):** ‡∏ï‡∏±‡∏ß‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î/‡∏Å‡∏≤‡∏£‡∏¢‡∏∑‡∏î (Strain) ‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏õ‡∏≠‡∏î ‡∏Ñ‡∏ß‡∏£‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÉ‡∏´‡πâ **Driving P &lt; 15** cmH<sub>2</sub>O</li>
                <li>**PEEPi (AutoPEEP):** ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏ñ‡∏∏‡∏á‡∏•‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏≠‡∏≠‡∏Å‡πÑ‡∏°‡πà‡∏´‡∏°‡∏î ‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏†‡∏≤‡∏ß‡∏∞ <strong class="highlight">Air Trapping</strong></li>
                <li>**Cstat (Static Compliance):** Vt / Driving P ‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏ñ‡∏∂‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏Ç‡πá‡∏á‡πÅ‡∏£‡∏á‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏õ‡∏≠‡∏î (Stiffness)</li>
                <li>**SpO<sub>2</sub> (Estimated):** ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏à‡∏≤‡∏Å **Shunt** ‡πÅ‡∏•‡∏∞ **FiO<sub>2</sub>**</li>
                <li>**EtCO<sub>2</sub> (Estimated):** ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏à‡∏≤‡∏Å MV ‡πÅ‡∏•‡∏∞ **Deadspace**</li>
            </ul>
        </div>
        
        <hr>
        <h2><span class="icon">üìâ</span> 6. ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÉ‡∏ô‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡∏û‡∏¢‡∏≤‡∏ò‡∏¥‡∏™‡∏†‡∏≤‡∏û‡∏ï‡πà‡∏≤‡∏á‡πÜ</h2>
        <p>‡∏Å‡∏≤‡∏£‡∏ï‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏£‡∏≤‡∏ü‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏õ‡∏≠‡∏î‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏õ‡πà‡∏ß‡∏¢‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô Resistance ‡∏´‡∏£‡∏∑‡∏≠ Compliance ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏≤‡∏¢‡πÉ‡∏à (‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö):</p>

        <h3><span class="icon">üß±</span> 6.1 ARDS / Fibrosis (Restrictive: Low C)</h3>
        <div class="info-box graph-box">
            <p><strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏õ‡∏≠‡∏î‡πÅ‡∏Ç‡πá‡∏á (Low C) ‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢</p>
            <ul>
                <li>**P-V Loop:** **‡∏ä‡∏±‡∏ô‡∏°‡∏≤‡∏Å** (Steep Slope) ‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ‡∏ñ‡∏∂‡∏á **C<sub>stat</sub> ‡∏ï‡πà‡∏≥**</li>
                <li>**P-T Graph:** P<sub>peak</sub> ‡πÅ‡∏•‡∏∞ P<sub>plat</sub> **‡∏™‡∏π‡∏á‡∏°‡∏≤‡∏Å** ‡πÅ‡∏ï‡πà‡∏´‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏ô‡πâ‡∏≠‡∏¢ (‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å Elasticity)</li>
            </ul>
        </div>

        <h3><span class="icon">üï≥Ô∏è</span> 6.2 COPD / Asthma (Obstructive: High R)</h3>
        <div class="info-box graph-box">
            <p><strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏ó‡∏≤‡∏á‡πÄ‡∏î‡∏¥‡∏ô‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏ï‡∏µ‡∏ö (High R) ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡πÄ‡∏Ç‡πâ‡∏≤-‡∏≠‡∏≠‡∏Å‡∏ä‡πâ‡∏≤ ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏≤‡∏¢‡πÉ‡∏à‡∏≠‡∏≠‡∏Å</p>
            <ul>
                <li>**P-T Graph:** P<sub>peak</sub> **‡∏™‡∏π‡∏á‡πÇ‡∏î‡∏î**, ‡πÅ‡∏ï‡πà P<sub>plat</sub> ‡πÑ‡∏°‡πà‡∏™‡∏π‡∏á (P<sub>peak</sub> - P<sub>plat</sub> ‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å ‡∏ö‡πà‡∏á‡∏ä‡∏µ‡πâ R ‡∏™‡∏π‡∏á)</li>
                <li>**F-T Graph:** Expiratory Flow **‡πÑ‡∏°‡πà‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏®‡∏π‡∏ô‡∏¢‡πå** ‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà (‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì Air Trapping)</li>
            </ul>
        </div>

        <h3><span class="icon">‚öñÔ∏è</span> 6.3 Dual-Lung Pathology (Unilateral Low C ‡∏´‡∏£‡∏∑‡∏≠ High R)</h3>
        <div class="info-box graph-box">
            <p><strong>‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞:</strong> ‡∏õ‡∏≠‡∏î‡∏ã‡πâ‡∏≤‡∏¢-‡∏Ç‡∏ß‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô (Uneven Ventilation) ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢ Flow ‡πÑ‡∏°‡πà‡∏™‡∏°‡πà‡∏≥‡πÄ‡∏™‡∏°‡∏≠</p>
            <ul>
                <li>**P-V Loop / F-V Loop:** ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏ó‡∏£‡∏á <strong class="highlight">‡∏ú‡∏¥‡∏î‡∏£‡∏π‡∏õ‡∏ó‡∏£‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞ Biphasic</strong> (‡∏°‡∏µ‡∏£‡∏≠‡∏¢‡∏´‡∏±‡∏Å 2 ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏∞) ‡πÉ‡∏ô‡πÇ‡∏´‡∏°‡∏î Pressure Control ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏õ‡∏≠‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏°‡∏µ Time Constant ‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô</li>
                <li>**Monitor:** ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á Flow ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏õ‡∏≠‡∏î‡∏ã‡πâ‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ç‡∏ß‡∏≤ (F<sub>L</sub> vs F<sub>R</sub>) ‡∏ö‡∏ô‡∏Å‡∏£‡∏≤‡∏ü Flow-Time</li>
            </ul>
        </div>
    </div>

    <script>
        // --- 1. CONFIGURATION ---
        const PRESETS = {
            'NORMAL': { resL: 15, compL: 50, resR: 15, compR: 50, name: 'Normal' },
            'ARDS': { resL: 15, compL: 30, resR: 15, compR: 30, name: 'ARDS' },
            'COPD': { resL: 20, compL: 45, resR: 20, compR: 45, name: 'COPD' },
            'DUAL': { resL: 5, compL: 50, resR: 20, compR: 20, name: 'Dual-Lung' }
        };
        
        // Ventilator Settings
        const SETTINGS = {
            mode: 'PCV',
            Pinsp: 10,
            PEEP: 5,
            RR: 14,
            Ti: 1.0,
            Pmus: 0
        };

        // State
        let isRunning = true;
        let currentPreset = PRESETS['NORMAL'];
        let state = {
            time: 0,
            cycleTime: 0,
            phase: 'EXP', 
            volL: (5 * 50)/1000, 
            volR: (5 * 50)/1000,
            paw: 5,
            flow: 0
        };

        // History Buffers for Canvas
        // Buffer for ~32 seconds to show 6-7 complete cycles (RR14 -> cycle ~4.2s)
        const MAX_POINTS = 2000; 
        let history = { p: [], f: [], v: [] };
        // Loops removed

        // --- 2. PHYSICS ENGINE ---
        function updatePhysics() {
            const dt = 0.016; // 60fps
            state.time += dt;
            state.cycleTime += dt;

            // Cycle Logic
            const cycleDuration = 60 / SETTINGS.RR;
            const expDuration = cycleDuration - SETTINGS.Ti;

            if (state.phase === 'INS' && state.cycleTime >= SETTINGS.Ti) {
                state.phase = 'EXP';
                state.cycleTime = 0;
            } else if (state.phase === 'EXP' && state.cycleTime >= expDuration) {
                state.phase = 'INS';
                state.cycleTime = 0;
            }

            // Target Pressure (PCV)
            let targetPaw = SETTINGS.PEEP;
            if (state.phase === 'INS') {
                targetPaw = SETTINGS.PEEP + SETTINGS.Pinsp;
            }

            // Smooth Pressure Rise (RC filter for machine valve)
            state.paw += (targetPaw - state.paw) * 0.15;

            // Equation of Motion: Flow = (Paw - Palv) / R
            // Palv = Vol / C
            
            // Left Lung
            const PalvL = (state.volL * 1000) / currentPreset.compL;
            const FlowL = (state.paw - PalvL) / currentPreset.resL; // L/s
            state.volL += FlowL * dt;

            // Right Lung
            const PalvR = (state.volR * 1000) / currentPreset.compR;
            const FlowR = (state.paw - PalvR) / currentPreset.resR; // L/s
            state.volR += FlowR * dt;

            // Total Flow & Volume
            state.flow = FlowL + FlowR;
            const totalVol = (state.volL + state.volR) * 1000; // ml
            
            // Calculate Vt (Volume relative to PEEP baseline)
            // This shows purely the tidal volume entering/leaving, excluding PEEP volume.
            const volumeAtPEEP = (SETTINGS.PEEP * (currentPreset.compL + currentPreset.compR));
            const relVol = totalVol - volumeAtPEEP; 

            // Update History
            history.p.push(state.paw);
            history.f.push(state.flow * 60); // L/min
            history.v.push(relVol);
            
            if (history.p.length > MAX_POINTS) {
                history.p.shift(); history.f.shift(); history.v.shift();
            }

            // Update Monitors (Approx)
            if (state.phase === 'EXP' && state.cycleTime < dt*2) {
                // End of Insp
                document.getElementById('val-ppeak').innerText = Math.round(state.paw);
                document.getElementById('val-vte').innerText = Math.round(relVol); // Corrected: Use relVol directly
                document.getElementById('val-mv').innerText = ((relVol * SETTINGS.RR)/1000).toFixed(1);
            }
        }

        // --- 3. RENDERING ---
        function getMinMax(data, type) {
            if (data.length === 0) return { min: 0, max: 10 };
            
            let min = Math.min(...data);
            let max = Math.max(...data);
            
            // Auto-scale padding
            let range = max - min;
            if (range === 0) range = 10;
            
            // Specific logic for types
            if (type === 'P') { min = 0; max = Math.max(30, max + range * 0.1); } // P always starts at 0
            else if (type === 'V') { min = -50; max = Math.max(500, max + range * 0.1); } // V starts near 0
            else if (type === 'F') { // Flow needs symmetry or fit
                let absMax = Math.max(Math.abs(min), Math.abs(max));
                min = -absMax * 1.1; max = absMax * 1.1;
            }
            
            return { min, max };
        }

        function draw() {
            if (isRunning) updatePhysics();
            
            drawWaveform('waveforms', [history.p, history.f, history.v], ['#f7b44e', '#4ade80', '#4a90e2']);
            
            requestAnimationFrame(draw);
        }

        function drawWaveform(canvasId, dataArrays, colors) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            const w = canvas.width = canvas.parentElement.offsetWidth;
            const h = canvas.height;
            ctx.clearRect(0, 0, w, h);

            // Draw Grids & Labels
            const zoneH = h / 3;
            ctx.strokeStyle = '#333'; ctx.lineWidth = 1;
            ctx.beginPath(); ctx.moveTo(0, zoneH); ctx.lineTo(w, zoneH); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(0, 2*zoneH); ctx.lineTo(w, 2*zoneH); ctx.stroke();
            
            // Titles
            ctx.font = '10px sans-serif'; 
            ctx.fillStyle = colors[0]; ctx.fillText('Paw (cmH2O)', 5, 15);
            ctx.fillStyle = colors[1]; ctx.fillText('Flow (L/min)', 5, zoneH + 15);
            ctx.fillStyle = colors[2]; ctx.fillText('Vol (ml)', 5, 2*zoneH + 15);

            // Draw Lines with Auto-Scale
            const types = ['P', 'F', 'V'];
            
            dataArrays.forEach((data, idx) => {
                ctx.beginPath();
                ctx.strokeStyle = colors[idx];
                ctx.lineWidth = 2;
                
                const bounds = getMinMax(data, types[idx]);
                const range = bounds.max - bounds.min;
                const yOffset = idx * zoneH;
                
                // Draw Min/Max labels
                ctx.fillStyle = colors[idx];
                ctx.textAlign = "right";
                ctx.fillText(Math.round(bounds.max), w - 5, yOffset + 15);
                ctx.fillText(Math.round(bounds.min), w - 5, yOffset + zoneH - 5);
                ctx.textAlign = "left";

                for (let i = 0; i < data.length; i++) {
                    const x = (i / MAX_POINTS) * w;
                    let val = data[i];
                    // Normalize to 0-1 then project to zone
                    let norm = (val - bounds.min) / range;
                    let y = yOffset + zoneH - (norm * zoneH); // Invert Y
                    
                    if (i===0) ctx.moveTo(x, y); else ctx.lineTo(x, y);
                }
                ctx.stroke();
            });
        }

        // --- 4. CONTROLS ---
        function setPreset(key) {
            currentPreset = PRESETS[key];
            document.querySelectorAll('.btn:not(.control-btn)').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            
            // Reset state slightly to show change effect
            state.volL = (SETTINGS.PEEP * currentPreset.compL)/1000;
            state.volR = (SETTINGS.PEEP * currentPreset.compR)/1000;
        }

        function toggleSim() {
            isRunning = !isRunning;
            const btn = document.getElementById('btn-toggle');
            if (isRunning) {
                btn.innerText = "‚è∏ Pause";
                btn.classList.remove('paused');
            } else {
                btn.innerText = "‚ñ∂ Play";
                btn.classList.add('paused');
            }
        }

        // Start
        draw();

    </script>
</body>
</html>
